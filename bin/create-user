var options = require('commander')
var models = require('../lib/models')

var User = models.User

options
  .option('-e, --email <value>', 'User email')
  .option('-p, --password <value>', 'User password')
  .parse(process.argv)

models.ready()
  .then(function () {
    var user = new User({email: options.email})
    User.register(user, options.password, function (err, user) {
      if (err) {
        console.error(err)
        return process.exit(1)
      }

      console.log('User created!')
      console.log(user)
      process.exit(0)
    })
  })
